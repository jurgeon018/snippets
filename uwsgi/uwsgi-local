
pip install uwsgi




uwsgi  --http :8001 --module _itbursa.wsgi


uwsgi.ini
    [uwsgi]
    module=itbursa.wsgi:application
    http=:8001
uwsgi --ini uwsgi.ini
127.0.0.1:8001/
https://uwsgi-docs.readthedocs.io/en/latest/tutorials/Django_and_nginx.html






sudo apt-get --purge remove apache2
sudo apt-get remove apache2*
/etc/init.d/apache2 stop (https://www.cyberciti.biz/faq/star-stop-restart-apache2-webserver/)
sudo fuser -k 80/tcp


sudo apt-get install nginx
cd /var/log
mkdir nginx
sudo chown -R www-data:www-data /var/log/nginx;
sudo chmod -R 755 /var/log/nginx;
sudo nginx
sudo service nginx start
127.0.0.1
0.0.0.0


cd /etc/nginx/sites-available/ # доступные сайты
# nginx может обрабатывать и выдавать больше чем один сайт. 1 файл настроек - один сайт. 
nano default # дефолтный сайт-заглушка
sudo touch.py pybursa # наш сайт
sudo nano pybursa

server {
    listen      8002;
    server_name 127.0.0.1;
    charset     utf-8;
    client_max_body_size 75M;    # adjust to taste

    location /media {
        alias /home/jurgeon/Dropbox/dev/django_projects/_itbursa/media;
    }
    location /static/ {
        root /home/jurgeon/Dropbox/dev/django_projects/_itbursa;
    }
    location / {
        include     uwsgi_params;
        # какой то важный нужный обязательный параметр
        proxy_pass  http://127.0.0.1:8001;
    } 
        # запросы, которые приходят из nginxa на корень /, проксируются на uwsgi, который в соседней консоли запущен по адресу 127.0.0.1:8001
}
# location - директивы, которые сервят статику по указанному пути /media/, /static/ или /. Запросы, которые приходят по указаному пути будут обрабатываться полным путем к нужной папке или полным путем к нужному урлу в браузере.


# после создние конфига в папке available, он еще не стал доступным. Чтобы конфиг стал доступен, нужно чтобы он появился в sites-enabled
cd /etc/nginx/sites-enabled
sudo ln -s /etc/nginx/sites-available/pybursa . 
 # ln -s создает символический линк из папки /etc/nginx/sites/available/pybursa в текущую папку .



cd /etc/nginx
nano nginx.conf
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;
    # логи, на случай если что-то пойдет не так

    include /etc/nginx/conf.d/*.conf; # конфиги, которые расширяют дефолтные
    include /etc/nginx/sites-enabled/*; # будем создавать линки, чтобы сделать сайт активным. В sites-enabled помещаем символический линк конфига, тем самым расширив конфиг nginxa. Таким образом nginx может обрабатывать много сайтов. Нужно их просто помещать в available, и создавать на них ссылку из enabled. 
# nginx может поднять 1-2-3-10 сайтов, и для каждого будет свой конфиг. Но при этом если конфиг одного сайта был сделан неправильно, то все 10 сайтов упадут. Поэтому для этого сначала надо его оттестировать


sudo chmod -R 664 /home/jurgeon/Dropbox/dev/django_projects/_itbursa/static/
sudo chmod -R a+X /home/jurgeon/Dropbox/dev/django_projects/_itbursa/static/
sudo chmod -R _itbursa
sudo nano /etc/ngnix/nginx.conf
    user jurgeon staff;
    # user www-data;
sudo nginx -t
sudo nginx -s stop
sudo nginx
127.0.0.1:8002/


